{"/app/backend/src/api.spec.ts":{"path":"/app/backend/src/api.spec.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":15},"end":{"line":12,"column":30}},"14":{"start":{"line":13,"column":20},"end":{"line":13,"column":40}},"15":{"start":{"line":14,"column":17},"end":{"line":14,"column":36}},"16":{"start":{"line":15,"column":12},"end":{"line":15,"column":45}},"17":{"start":{"line":16,"column":0},"end":{"line":21,"column":3}},"18":{"start":{"line":17,"column":4},"end":{"line":20,"column":8}},"19":{"start":{"line":17,"column":33},"end":{"line":20,"column":6}},"20":{"start":{"line":18,"column":20},"end":{"line":18,"column":72}},"21":{"start":{"line":19,"column":8},"end":{"line":19,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"loc":{"start":{"line":16,"column":27},"end":{"line":21,"column":1}},"line":16},"8":{"name":"(anonymous_8)","decl":{"start":{"line":17,"column":27},"end":{"line":17,"column":28}},"loc":{"start":{"line":17,"column":33},"end":{"line":20,"column":6}},"line":17},"9":{"name":"(anonymous_9)","decl":{"start":{"line":17,"column":67},"end":{"line":17,"column":68}},"loc":{"start":{"line":17,"column":80},"end":{"line":20,"column":5}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":2,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":2,"7":1,"8":1,"9":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,1],"4":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/api.spec.ts","sources":["/app/backend/src/api.spec.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,+BAA8B;AAC9B,yCAA6C;AAC7C,qCAAkC;AAElC,MAAM,GAAG,GAAG,IAAI,eAAM,EAAE,CAAC,SAAS,EAAE,CAAC;AAErC,QAAQ,CAAC,UAAU,EAAE,GAAG,EAAE;IACxB,EAAE,CAAC,kBAAkB,EAAE,GAAS,EAAE;QAChC,MAAM,GAAG,GAAG,MAAM,iBAAO,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACvD,aAAM,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC;IACpC,CAAC,CAAA,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA","sourcesContent":["import { expect } from \"chai\";\nimport { agent as request } from \"supertest\";\nimport { Server } from './server';\n\nconst app = new Server().getServer();\n\ndescribe('api test', () => {\n  it('can get app info', async () => {\n    const res = await request(app).get('/api').expect(200);\n    expect(res.body.version).to.exist;\n  })\n})\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5601f0d6c069a2e9dc775e691ea9d4fe80d8744c"},"/app/backend/src/server.ts":{"path":"/app/backend/src/server.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":24}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":53}},"5":{"start":{"line":8,"column":17},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":20},"end":{"line":9,"column":40}},"7":{"start":{"line":10,"column":21},"end":{"line":10,"column":51}},"8":{"start":{"line":11,"column":24},"end":{"line":11,"column":57}},"9":{"start":{"line":12,"column":22},"end":{"line":12,"column":53}},"10":{"start":{"line":13,"column":15},"end":{"line":13,"column":47}},"11":{"start":{"line":14,"column":14},"end":{"line":14,"column":30}},"12":{"start":{"line":17,"column":8},"end":{"line":17,"column":45}},"13":{"start":{"line":18,"column":8},"end":{"line":18,"column":45}},"14":{"start":{"line":21,"column":8},"end":{"line":21,"column":51}},"15":{"start":{"line":22,"column":8},"end":{"line":22,"column":53}},"16":{"start":{"line":23,"column":8},"end":{"line":23,"column":59}},"17":{"start":{"line":24,"column":8},"end":{"line":24,"column":55}},"18":{"start":{"line":25,"column":8},"end":{"line":25,"column":47}},"19":{"start":{"line":26,"column":8},"end":{"line":26,"column":53}},"20":{"start":{"line":27,"column":8},"end":{"line":27,"column":49}},"21":{"start":{"line":28,"column":8},"end":{"line":32,"column":11}},"22":{"start":{"line":29,"column":12},"end":{"line":31,"column":15}},"23":{"start":{"line":30,"column":16},"end":{"line":30,"column":81}},"24":{"start":{"line":35,"column":24},"end":{"line":47,"column":9}},"25":{"start":{"line":48,"column":8},"end":{"line":55,"column":148}},"26":{"start":{"line":55,"column":36},"end":{"line":55,"column":146}},"27":{"start":{"line":58,"column":8},"end":{"line":62,"column":11}},"28":{"start":{"line":65,"column":8},"end":{"line":65,"column":27}},"29":{"start":{"line":68,"column":0},"end":{"line":68,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":18},"end":{"line":19,"column":5}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":12},"end":{"line":33,"column":5}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":28,"column":35},"end":{"line":28,"column":36}},"loc":{"start":{"line":28,"column":41},"end":{"line":32,"column":9}},"line":28},"4":{"name":"(anonymous_4)","decl":{"start":{"line":29,"column":42},"end":{"line":29,"column":43}},"loc":{"start":{"line":29,"column":48},"end":{"line":31,"column":13}},"line":29},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":22},"end":{"line":56,"column":5}},"line":34},"6":{"name":"(anonymous_6)","decl":{"start":{"line":55,"column":22},"end":{"line":55,"column":23}},"loc":{"start":{"line":55,"column":36},"end":{"line":55,"column":146}},"line":55},"7":{"name":"(anonymous_7)","decl":{"start":{"line":57,"column":4},"end":{"line":57,"column":5}},"loc":{"start":{"line":57,"column":25},"end":{"line":63,"column":5}},"line":57},"8":{"name":"(anonymous_8)","decl":{"start":{"line":64,"column":4},"end":{"line":64,"column":5}},"loc":{"start":{"line":64,"column":16},"end":{"line":66,"column":5}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":17,"column":20},"end":{"line":17,"column":44}},"type":"binary-expr","locations":[{"start":{"line":17,"column":20},"end":{"line":17,"column":36}},{"start":{"line":17,"column":40},"end":{"line":17,"column":44}}],"line":17}},"s":{"0":1,"1":3,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":2,"13":2,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":2,"25":2,"26":0,"27":0,"28":2,"29":1},"f":{"0":3,"1":2,"2":0,"3":0,"4":0,"5":2,"6":0,"7":0,"8":2},"b":{"0":[1,1,1],"1":[0,3],"2":[3,3],"3":[2,2]},"inputSourceMap":{"version":3,"file":"/app/backend/src/server.ts","sources":["/app/backend/src/server.ts"],"names":[],"mappings":";;;;;;AAAA,sDAA+C;AAC/C,oDAA4B;AAC5B,yCAAsC;AACtC,oDAA2C;AAC3C,0DAA+C;AAC/C,sDAA2C;AAE3C,gDAAwB;AACxB,+BAAoC;AAEpC,MAAa,MAAM;IAKf;QAFQ,SAAI,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC;QAGpC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;IACzC,CAAC;IAEM,KAAK;QACR,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC3C,iBAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAChC,uBAAO,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACnC,mBAAK,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACjC,iBAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,uBAAO,CAAC,kBAAkB,EAAE,CAAC;QAC7B,mBAAK,CAAC,kBAAkB,EAAE,CAAC;QAE3B,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YAC5B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE;gBAC/B,OAAO,CAAC,GAAG,CAAC,wCAAwC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;YACrE,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,eAAe;QAEnB,MAAM,OAAO,GAAqB;YAC9B,cAAc,EAAE;gBACZ,QAAQ;gBACR,kBAAkB;gBAClB,cAAc;gBACd,QAAQ;gBACR,gBAAgB;aACnB;YACD,WAAW,EAAE,IAAI;YACjB,OAAO,EAAE,wCAAwC;YACjD,MAAM,EAAE,oBAAoB,IAAI,CAAC,IAAI,EAAE;YACvC,iBAAiB,EAAE,KAAK;SAC3B,CAAC;QAEF,OAAO,iBAAO,EAAE;aACX,GAAG,CAAC,cAAI,EAAE,CAAC;aACX,GAAG,CAAC,iBAAO,CAAC,IAAI,EAAE,CAAC;aACnB,GAAG,CAAC,gBAAM,CAAC,MAAM,CAAC,CAAC;aACnB,GAAG,CAAC,MAAM,EAAE,mBAAa,CAAC;aAC1B,OAAO,CAAC,GAAG,EAAE,cAAI,CAAC,OAAO,CAAC,CAAC;aAC3B,GAAG,CAAC,iBAAO,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;aAEnC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,oGAAoG,CAAC,CAAC,CAAC;IAChJ,CAAC;IAEO,kBAAkB;QACtB,OAAO,IAAI,qBAAS,CAAC;YACjB,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,WAAW;YACpB,OAAO,EAAE,KAAK;SACjB,CAAC,CAAC;IACP,CAAC;IAEM,SAAS;QACZ,OAAO,IAAI,CAAC,MAAM,CAAC;IACvB,CAAC;CACJ;AA/DD,wBA+DC","sourcesContent":["import express, { Application } from 'express';\nimport morgan from 'morgan';\nimport { Sequelize } from 'sequelize';\nimport { User } from './models/user.model';\nimport {Product} from './models/product.model';\nimport {Photo} from './models/photo.model';\n\nimport cors from 'cors';\nimport {ApiController} from './api';\n\nexport class Server {\n    private server: Application;\n    private sequelize: Sequelize;\n    private port = process.env.PORT || 3000;\n\n    constructor() {\n        this.server = this.configureServer();\n    }\n\n    public start() {\n        this.sequelize = this.configureSequelize();\n        User.initialize(this.sequelize);\n        Product.initialize(this.sequelize);\n        Photo.initialize(this.sequelize);\n        User.createAssociations();\n        Product.createAssociations();\n        Photo.createAssociations();\n\n        this.sequelize.sync().then(() => {                           // create connection to the database\n            this.server.listen(this.port, () => {                                   // start server on specified port\n                console.log(`server listening at http://localhost:${this.port}`);   // indicate that the server has started\n            });\n        });\n    }\n\n    private configureServer(): Application {\n        // options for cors middleware\n        const options: cors.CorsOptions = {\n            allowedHeaders: [\n                'Origin',\n                'X-Requested-With',\n                'Content-Type',\n                'Accept',\n                'X-Access-Token',\n            ],\n            credentials: true,\n            methods: 'GET,HEAD,OPTIONS,PUT,PATCH,POST,DELETE',\n            origin: `http://localhost:${this.port}`,\n            preflightContinue: false,\n        };\n\n        return express()\n            .use(cors())\n            .use(express.json())                    // parses an incoming json to an object\n            .use(morgan('tiny'))                    // logs incoming requests\n            .use('/api', ApiController)\n            .options('*', cors(options))\n            .use(express.static('./src/public'))\n            // this is the message you get if you open http://localhost:3000/ when the server is running\n            .get('/', (req, res) => res.send('<h1>Welcome to the ESE-2020 Backend Scaffolding <span style=\"font-size:50px\">&#127881;</span></h1>'));\n    }\n\n    private configureSequelize(): Sequelize {\n        return new Sequelize({\n            dialect: 'sqlite',\n            storage: 'db.sqlite',\n            logging: false // can be set to true for debugging\n        });\n    }\n\n    public getServer() {\n        return this.server;\n    }\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"92ec49817b6f9f413d69084825e55813be85b295"},"/app/backend/src/models/user.model.ts":{"path":"/app/backend/src/models/user.model.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":22}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":24},"end":{"line":5,"column":50}},"4":{"start":{"line":8,"column":8},"end":{"line":74,"column":11}},"5":{"start":{"line":77,"column":8},"end":{"line":77,"column":46}},"6":{"start":{"line":80,"column":0},"end":{"line":80,"column":20}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":4},"end":{"line":7,"column":5}},"loc":{"start":{"line":7,"column":33},"end":{"line":75,"column":5}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":76,"column":4},"end":{"line":76,"column":5}},"loc":{"start":{"line":76,"column":32},"end":{"line":78,"column":5}},"line":76}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":1},"f":{"0":0,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/backend/src/models/user.model.ts","sources":["/app/backend/src/models/user.model.ts"],"names":[],"mappings":";;;AAAA,yCAAkE;AAClE,mDAAwC;AAoBxC,MAAa,IAAK,SAAQ,iBAA6C;IAe5D,MAAM,CAAC,UAAU,CAAC,SAAoB;QACzC,IAAI,CAAC,IAAI,CAAC;YACN,EAAE,EAAE;gBACA,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,aAAa,EAAE,IAAI;gBACnB,UAAU,EAAE,IAAI;aACnB;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;gBAChB,QAAQ,EAAE;oBACN,QAAQ,EAAE;wBACN,GAAG,EAAE,yBAAyB;qBACjC;iBACJ;gBACD,MAAM,EAAE,IAAI;aACf;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aASnB;YACD,KAAK,EAAE;gBACH,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;gBAChB,QAAQ,EAAE;oBACN,QAAQ,EAAE;wBACN,GAAG,EAAE,uBAAuB;qBAC/B;oBACD,OAAO,EAAE;wBACL,GAAG,EAAE,+CAA+C;qBACvD;iBACJ;gBACD,MAAM,EAAE,IAAI;aACf;YACD,SAAS,EAAE;gBACP,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,OAAO,EAAE;gBACL,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,YAAY,EAAE,KAAK;aACtB;YACD,MAAM,EAAE;gBACJ,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;YACD,KAAK,EAAE;gBACH,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;YACD,GAAG,EAAE;gBACD,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;YACD,MAAM,EAAE;gBACJ,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;YACD,IAAI,EAAE;gBACF,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;YACD,OAAO,EAAE;gBACL,IAAI,EAAE,qBAAS,CAAC,MAAM;aACzB;SACJ,EACG;YACI,SAAS;YACT,SAAS,EAAE,OAAO;SACrB,CACJ,CAAC;IACN,CAAC;IAEM,MAAM,CAAC,kBAAkB;QAC5B,IAAI,CAAC,OAAO,CAAC,uBAAO,CAAC,CAAC;IAC1B,CAAC;CACJ;AAlGD,oBAkGC","sourcesContent":["import { Optional, Model, Sequelize, DataTypes } from 'sequelize';\nimport {Product} from './product.model';\n\nexport interface UserAttributes {\n    id: number;\n    userName: string;\n    password: string;\n    email: string;\n    firstName: string;\n    lastName: string;\n    isAdmin?: boolean;\n    gender?: string;\n    phone?: string;\n    street?: string;\n    zip?: string;\n    city?: string;\n    country?: string;\n}\n\nexport interface UserCreationAttributes extends Optional<UserAttributes, 'id'> { }\n\nexport class User extends Model<UserAttributes, UserCreationAttributes> implements UserAttributes {\n    id!: number;\n    userName!: string;\n    password!: string;\n    email: string;\n    firstName: string;\n    lastName: string;\n    isAdmin?: boolean;\n    gender?: string;\n    phone?: string;\n    street?: string;\n    zip?: string;\n    city?: string;\n    country?: string;\n\n    public static initialize(sequelize: Sequelize) {\n        User.init({\n            id: {\n                type: DataTypes.INTEGER,\n                autoIncrement: true,\n                primaryKey: true\n            },\n            userName: {\n                type: DataTypes.STRING,\n                allowNull: false,\n                validate: {\n                    notEmpty: {\n                        msg: 'Please enter a username'\n                    }\n                },\n                unique: true\n            },\n            password: {\n                type: DataTypes.STRING,\n                allowNull: false,\n                // validate: {\n                //     is: [\n                //         '/[A-Z]+/g',\n                //         '/[a-z]+/g',\n                //         '/[0-9]+/g',\n                //         '/[!@#$%^&*()_+\\-=\\[\\]{};\\':\"\\\\|,.<>\\/?]+/'\n                //     ]\n                // }\n            },\n            email: {\n                type: DataTypes.STRING,\n                allowNull: false,\n                validate: {\n                    notEmpty: {\n                        msg: 'Please enter an email'\n                    },\n                    isEmail: {\n                        msg: 'Please use valid format (e.g. team8@ese20.ch)',\n                    }\n                },\n                unique: true\n            },\n            firstName: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            lastName: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            isAdmin: {\n                type: DataTypes.BOOLEAN,\n                defaultValue: false\n            },\n            gender: {\n                type: DataTypes.STRING\n            },\n            phone: {\n                type: DataTypes.STRING\n            },\n            zip: {\n                type: DataTypes.STRING\n            },\n            street: {\n                type: DataTypes.STRING\n            },\n            city: {\n                type: DataTypes.STRING\n            },\n            country: {\n                type: DataTypes.STRING\n            }\n        },\n            {\n                sequelize,\n                tableName: 'users'\n            }\n        );\n    }\n\n    public static createAssociations() {\n        User.hasMany(Product);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f243214cd7108ae438887490f680d758564c3d96"},"/app/backend/src/models/product.model.ts":{"path":"/app/backend/src/models/product.model.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":22},"end":{"line":6,"column":46}},"5":{"start":{"line":9,"column":8},"end":{"line":61,"column":49}},"6":{"start":{"line":64,"column":8},"end":{"line":64,"column":45}},"7":{"start":{"line":65,"column":8},"end":{"line":65,"column":45}},"8":{"start":{"line":68,"column":0},"end":{"line":68,"column":26}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":33},"end":{"line":62,"column":5}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":32},"end":{"line":66,"column":5}},"line":63}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1},"f":{"0":0,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/backend/src/models/product.model.ts","sources":["/app/backend/src/models/product.model.ts"],"names":[],"mappings":";;;AAAA,yCAA+F;AAC/F,6CAAkC;AAClC,+CAAoC;AAqBpC,MAAa,OAAQ,SAAQ,iBAAmD;IAiBrE,MAAM,CAAC,UAAU,CAAC,SAAoB;QACzC,OAAO,CAAC,IAAI,CAAC;YACT,EAAE,EAAE;gBACA,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,aAAa,EAAE,IAAI;gBACnB,UAAU,EAAE,IAAI;aACnB;YACD,MAAM,EAAE;gBACJ,IAAI,EAAE,qBAAS,CAAC,OAAO;aAC1B;YACD,KAAK,EAAE;gBACH,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,WAAW,EAAE;gBACT,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,KAAK,EAAE;gBACH,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,SAAS,EAAE,KAAK;aACnB;YACD,WAAW,EAAE;gBACT,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,YAAY,EAAE;gBACV,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,YAAY,EAAE;gBACV,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,SAAS,EAAE,KAAK;aACnB;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,SAAS,EAAE,KAAK;aACnB;YACD,MAAM,EAAE;gBACJ,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,YAAY,EAAE,SAAS;gBACvB,QAAQ,EAAE;oBACN,IAAI,EAAE,CAAC,CAAC,SAAS,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;iBAC9C;aACJ;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,SAAS,EAAE,KAAK;aACnB;SACJ,EACD,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,CACnC,CAAC;IAEN,CAAC;IAEM,MAAM,CAAC,kBAAkB;QAC5B,OAAO,CAAC,SAAS,CAAC,iBAAI,CAAC,CAAC;QACxB,OAAO,CAAC,OAAO,CAAC,mBAAK,CAAC,CAAC;IAC3B,CAAC;CAEJ;AAjFD,0BAiFC","sourcesContent":["import { Optional, Model, Sequelize, DataTypes, HasManyGetAssociationsMixin } from 'sequelize';\nimport {User} from './user.model';\nimport {Photo} from './photo.model';\n\nexport interface ProductAttributes {\n    id: number;\n    title: string;\n    description: string;\n    price: number;\n    productType: string;\n    purchaseType: string;\n    availability: boolean;\n    location: string;\n    delivery: boolean;\n    status: string;\n    UserId: number;\n    duration: number;\n}\n\n// tells sequelize that todoItemId is not a required field\nexport interface ProductCreationAttributes extends Optional<ProductAttributes, 'id'> { }\n\n\nexport class Product extends Model<ProductAttributes, ProductCreationAttributes> implements ProductAttributes {\n    id!: number;\n    title!: string;\n    description!: string;\n    price!: number;\n    productType!: string;\n    purchaseType!: string;\n    availability!: boolean;\n    location!: string;\n    delivery!: boolean;\n    status!: string;\n    UserId!: number;\n    duration!: number;\n\n    public getPhotos!: HasManyGetAssociationsMixin<Photo>;\n\n\n    public static initialize(sequelize: Sequelize) { // definition for database\n        Product.init({\n            id: {\n                type: DataTypes.INTEGER,\n                autoIncrement: true,\n                primaryKey: true\n            },\n            UserId: {\n                type: DataTypes.INTEGER,\n            },\n            title: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            description: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            price: {\n                type: DataTypes.INTEGER,\n                allowNull: false\n            },\n            productType: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            purchaseType: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            availability: {\n                type: DataTypes.BOOLEAN,\n                allowNull: false\n            },\n            location: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n            delivery: {\n                type: DataTypes.BOOLEAN,\n                allowNull: false\n            },\n            status: {\n                type: DataTypes.STRING,\n                defaultValue: 'pending',\n                validate: {\n                    isIn: [['pending', 'approved', 'inactive']],\n                }\n            },\n            duration: {\n                type: DataTypes.INTEGER,\n                allowNull: false\n            },\n        },\n        { sequelize, tableName: 'products' }\n        );\n\n    }\n\n    public static createAssociations() {\n        Product.belongsTo(User);\n        Product.hasMany(Photo);\n    }\n\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5e94c50e57ac0b7d68b0610612bedc77b631919e"},"/app/backend/src/models/photo.model.ts":{"path":"/app/backend/src/models/photo.model.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":24},"end":{"line":6,"column":50}},"5":{"start":{"line":9,"column":8},"end":{"line":25,"column":47}},"6":{"start":{"line":28,"column":8},"end":{"line":28,"column":43}},"7":{"start":{"line":29,"column":8},"end":{"line":29,"column":49}},"8":{"start":{"line":32,"column":0},"end":{"line":32,"column":22}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":33},"end":{"line":26,"column":5}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":32},"end":{"line":30,"column":5}},"line":27}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1},"f":{"0":0,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/backend/src/models/photo.model.ts","sources":["/app/backend/src/models/photo.model.ts"],"names":[],"mappings":";;;AACA,yCAAkE;AAClE,6CAAkC;AAClC,mDAAwC;AAaxC,MAAa,KAAM,SAAQ,iBAA+C;IAO/D,MAAM,CAAC,UAAU,CAAC,SAAoB;QACzC,KAAK,CAAC,IAAI,CAAC;YACP,EAAE,EAAE;gBACA,IAAI,EAAE,qBAAS,CAAC,OAAO;gBACvB,aAAa,EAAE,IAAI;gBACnB,UAAU,EAAE,IAAI;aACnB;YACD,MAAM,EAAE;gBACJ,IAAI,EAAE,qBAAS,CAAC,OAAO;aAC1B;YACD,SAAS,EAAE;gBACP,IAAI,EAAE,qBAAS,CAAC,OAAO;aAC1B;YACD,QAAQ,EAAE;gBACN,IAAI,EAAE,qBAAS,CAAC,MAAM;gBACtB,SAAS,EAAE,KAAK;aACnB;SACJ,EACD,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAE,CACjC,CAAC;IAEN,CAAC;IAEM,MAAM,CAAC,kBAAkB;QAC5B,KAAK,CAAC,SAAS,CAAC,iBAAI,CAAC,CAAC;QACtB,KAAK,CAAC,SAAS,CAAC,uBAAO,CAAC,CAAC;IAC7B,CAAC;CAEJ;AAnCD,sBAmCC","sourcesContent":["\nimport { Optional, Model, Sequelize, DataTypes } from 'sequelize';\nimport {User} from './user.model';\nimport {Product} from './product.model';\n\nexport interface PhotoAttributes {\n    id: number;\n    UserId: number;\n    fileName: string;\n    ProductId: number;\n}\n\n// tells sequelize that todoItemId is not a required field\nexport interface PhotoCreationAttributes extends Optional<Photo, 'id'> { }\n\n\nexport class Photo extends Model<PhotoAttributes, PhotoCreationAttributes> implements PhotoAttributes {\n    id: number;\n    UserId!: number;\n    fileName!: string;\n    ProductId!: number;\n\n\n    public static initialize(sequelize: Sequelize) { // definition for database\n        Photo.init({\n            id: {\n                type: DataTypes.INTEGER,\n                autoIncrement: true,\n                primaryKey: true\n            },\n            UserId: {\n                type: DataTypes.INTEGER,\n            },\n            ProductId: {\n                type: DataTypes.INTEGER,\n            },\n            fileName: {\n                type: DataTypes.STRING,\n                allowNull: false\n            },\n        },\n        { sequelize, tableName: 'images' }\n        );\n\n    }\n\n    public static createAssociations() {\n        Photo.belongsTo(User);\n        Photo.belongsTo(Product);\n    }\n\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f79a06abc49e6fcfe0ce15f566c24824ef790003"},"/app/backend/src/api.ts":{"path":"/app/backend/src/api.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":36}},"3":{"start":{"line":5,"column":26},"end":{"line":5,"column":66}},"4":{"start":{"line":6,"column":29},"end":{"line":6,"column":72}},"5":{"start":{"line":7,"column":30},"end":{"line":7,"column":74}},"6":{"start":{"line":8,"column":27},"end":{"line":8,"column":68}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":43}},"8":{"start":{"line":10,"column":0},"end":{"line":15,"column":61}},"9":{"start":{"line":11,"column":29},"end":{"line":11,"column":57}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":14},"end":{"line":11,"column":15}},"loc":{"start":{"line":11,"column":29},"end":{"line":11,"column":57}},"line":11}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/backend/src/api.ts","sources":["/app/backend/src/api.ts"],"names":[],"mappings":";;;AACA,qCAAoD;AACpD,mEAA6D;AAC7D,yEAAmE;AACnE,2EAAoE;AACpE,qEAA+D;AAElD,QAAA,aAAa,GAAG,gBAAM,EAAE,CAAC;AAEtC,qBAAa;KACV,GAAG,CAAC,GAAG,EAAE,CAAC,IAAa,EAAE,GAAa,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,KAAK,EAAC,CAAC,CAAC;KACtE,GAAG,CAAC,WAAW,EAAE,uCAAiB,CAAC;KACnC,GAAG,CAAC,SAAS,EAAE,kCAAe,CAAC;KAC/B,GAAG,CAAC,OAAO,EAAE,gCAAc,CAAC;KAC5B,GAAG,CAAC,UAAU,EAAE,sCAAiB,CAAC,CACpC","sourcesContent":["\nimport { Request, Response, Router } from 'express';\nimport {UserController} from './controllers/user.controller';\nimport {SecuredController} from './controllers/secured.controller';\nimport {ProductController} from './controllers/products.controller';\nimport {PhotoController} from './controllers/photo.controller';\n\nexport const ApiController = Router();\n\nApiController\n  .get('/', (_req: Request, res: Response) => res.json({version: '2.0'}))\n  .use('/products', ProductController)\n  .use('/images', PhotoController)\n  .use('/user', UserController)\n  .use('/secured', SecuredController)\n;\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d9f161f45b331b4428648b52b41945e7d9decb0d"},"/app/backend/src/controllers/user.controller.ts":{"path":"/app/backend/src/controllers/user.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":54}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":53}},"5":{"start":{"line":8,"column":23},"end":{"line":8,"column":58}},"6":{"start":{"line":9,"column":20},"end":{"line":9,"column":55}},"7":{"start":{"line":10,"column":32},"end":{"line":10,"column":79}},"8":{"start":{"line":11,"column":23},"end":{"line":11,"column":49}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":55}},"10":{"start":{"line":13,"column":0},"end":{"line":15,"column":3}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":124}},"12":{"start":{"line":14,"column":62},"end":{"line":14,"column":82}},"13":{"start":{"line":14,"column":97},"end":{"line":14,"column":122}},"14":{"start":{"line":16,"column":0},"end":{"line":19,"column":3}},"15":{"start":{"line":17,"column":4},"end":{"line":17,"column":26}},"16":{"start":{"line":18,"column":4},"end":{"line":18,"column":111}},"17":{"start":{"line":18,"column":54},"end":{"line":18,"column":69}},"18":{"start":{"line":18,"column":84},"end":{"line":18,"column":109}},"19":{"start":{"line":20,"column":0},"end":{"line":22,"column":3}},"20":{"start":{"line":21,"column":4},"end":{"line":21,"column":104}},"21":{"start":{"line":21,"column":47},"end":{"line":21,"column":62}},"22":{"start":{"line":21,"column":77},"end":{"line":21,"column":102}},"23":{"start":{"line":23,"column":0},"end":{"line":23,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":94},"end":{"line":15,"column":1}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":48},"end":{"line":14,"column":49}},"loc":{"start":{"line":14,"column":62},"end":{"line":14,"column":82}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":90},"end":{"line":14,"column":91}},"loc":{"start":{"line":14,"column":97},"end":{"line":14,"column":122}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":16,"column":30},"end":{"line":16,"column":31}},"loc":{"start":{"line":16,"column":44},"end":{"line":19,"column":1}},"line":16},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":45},"end":{"line":18,"column":46}},"loc":{"start":{"line":18,"column":54},"end":{"line":18,"column":69}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":18,"column":77},"end":{"line":18,"column":78}},"loc":{"start":{"line":18,"column":84},"end":{"line":18,"column":109}},"line":18},"7":{"name":"(anonymous_7)","decl":{"start":{"line":20,"column":49},"end":{"line":20,"column":50}},"loc":{"start":{"line":20,"column":63},"end":{"line":22,"column":1}},"line":20},"8":{"name":"(anonymous_8)","decl":{"start":{"line":21,"column":38},"end":{"line":21,"column":39}},"loc":{"start":{"line":21,"column":47},"end":{"line":21,"column":62}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":70},"end":{"line":21,"column":71}},"loc":{"start":{"line":21,"column":77},"end":{"line":21,"column":102}},"line":21}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1},"f":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/controllers/user.controller.ts","sources":["/app/backend/src/controllers/user.controller.ts"],"names":[],"mappings":";;;;;;AACA,sDAA6D;AAC7D,2DAAuD;AACvD,wDAAuD;AACvD,gFAA2E;AAE3E,MAAM,cAAc,GAAW,iBAAO,CAAC,MAAM,EAAE,CAAC;AACnC,QAAA,WAAW,GAAG,IAAI,0BAAW,EAAE,CAAC;AAE7C,cAAc,CAAC,IAAI,CAAC,WAAW,EAAE,6CAAqB,EAClD,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE;IAC5B,mBAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACpH,CAAC,CACJ,CAAC;AAEF,cAAc,CAAC,IAAI,CAAC,QAAQ,EACxB,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE;IAC5B,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACtB,mBAAW,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACvG,CAAC,CACJ,CAAC;AAEF,cAAc,CAAC,GAAG,CAAC,GAAG,EAAE,uBAAW,EAC/B,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE;IAC5B,mBAAW,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AAChG,CAAC,CACJ,CAAC;AAEW,QAAA,cAAc,GAAW,cAAc,CAAC","sourcesContent":["\nimport express, { Router, Request, Response } from 'express';\nimport { UserService } from '../services/user.service';\nimport { verifyToken } from '../middlewares/checkAuth';\nimport {checkPasswordStrength} from '../middlewares/checkPasswordStrength';\n\nconst userController: Router = express.Router();\nexport const userService = new UserService();\n\nuserController.post('/register', checkPasswordStrength,\n    (req: Request, res: Response) => {\n        userService.register(req.body).then(registered => res.send(registered)).catch(err => res.status(400).send(err));\n    }\n);\n\nuserController.post('/login',\n    (req: Request, res: Response) => {\n        console.log(req.body);\n        userService.login(req.body).then(login => res.send(login)).catch(err => res.status(403).send(err));\n    }\n);\n\nuserController.get('/', verifyToken, // you can add middleware on specific requests like that\n    (req: Request, res: Response) => {\n        userService.getAll().then(users => res.send(users)).catch(err => res.status(500).send(err));\n    }\n);\n\nexport const UserController: Router = userController;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f610568e13464157e840b3085586af6ddc2056e8"},"/app/backend/src/services/user.service.ts":{"path":"/app/backend/src/services/user.service.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"4":{"start":{"line":7,"column":21},"end":{"line":7,"column":52}},"5":{"start":{"line":8,"column":17},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":23},"end":{"line":9,"column":63}},"7":{"start":{"line":10,"column":20},"end":{"line":10,"column":40}},"8":{"start":{"line":13,"column":27},"end":{"line":13,"column":29}},"9":{"start":{"line":14,"column":8},"end":{"line":14,"column":77}},"10":{"start":{"line":15,"column":8},"end":{"line":15,"column":46}},"11":{"start":{"line":18,"column":23},"end":{"line":18,"column":45}},"12":{"start":{"line":19,"column":8},"end":{"line":36,"column":60}},"13":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"14":{"start":{"line":29,"column":30},"end":{"line":29,"column":155}},"15":{"start":{"line":30,"column":16},"end":{"line":30,"column":56}},"16":{"start":{"line":33,"column":16},"end":{"line":33,"column":69}},"17":{"start":{"line":36,"column":26},"end":{"line":36,"column":58}},"18":{"start":{"line":39,"column":8},"end":{"line":39,"column":43}},"19":{"start":{"line":42,"column":0},"end":{"line":42,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":19},"end":{"line":16,"column":5}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":26},"end":{"line":37,"column":5}},"line":17},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":18},"end":{"line":27,"column":19}},"loc":{"start":{"line":27,"column":26},"end":{"line":35,"column":9}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":36,"column":19},"end":{"line":36,"column":20}},"loc":{"start":{"line":36,"column":26},"end":{"line":36,"column":58}},"line":36},"5":{"name":"(anonymous_5)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":13},"end":{"line":40,"column":5}},"line":38}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},{"start":{"line":28,"column":12},"end":{"line":34,"column":13}}],"line":28}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1},"f":{"0":2,"1":0,"2":0,"3":0,"4":0,"5":0},"b":{"0":[1,1,1],"1":[0,2],"2":[2,2],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/services/user.service.ts","sources":["/app/backend/src/services/user.service.ts"],"names":[],"mappings":";;;;;;AAAA,qDAA4D;AAE5D,oDAA4B;AAC5B,gEAA+B;AAC/B,yCAA6B;AAE7B,MAAa,WAAW;IAEb,QAAQ,CAAC,IAAoB;QAChC,MAAM,UAAU,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC3D,OAAO,iBAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEM,KAAK,CAAC,cAA4B;QACrC,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;QACtC,OAAO,iBAAI,CAAC,OAAO,CAAC;YAChB,KAAK,EAAE;gBACH,CAAC,cAAE,CAAC,EAAE,CAAC,EAAE;oBACL,EAAE,QAAQ,EAAE,cAAc,CAAC,QAAQ,EAAE;oBACrC,EAAE,KAAK,EAAE,cAAc,CAAC,QAAQ,EAAE;iBACrC;aACJ;SACJ,CAAC;aACD,IAAI,CAAC,IAAI,CAAC,EAAE;YACT,IAAI,gBAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE;gBAC5D,MAAM,KAAK,GAAW,sBAAG,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,EAAE,MAAM,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACjI,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;aAC3C;iBAAM;gBACH,OAAO,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;aACxD;QACL,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;IACpD,CAAC;IAEM,MAAM;QACT,OAAO,iBAAI,CAAC,OAAO,EAAE,CAAC;IAC1B,CAAC;CACJ;AAhCD,kCAgCC","sourcesContent":["import { UserAttributes, User } from '../models/user.model';\nimport { LoginResponse, LoginRequest } from '../models/login.model';\nimport bcrypt from 'bcrypt';\nimport jwt from 'jsonwebtoken';\nimport {Op} from 'sequelize';\n\nexport class UserService {\n\n    public register(user: UserAttributes): Promise<UserAttributes> {\n        const saltRounds = 12;\n        user.password = bcrypt.hashSync(user.password, saltRounds); // hashes the password, never store passwords as plaintext\n        return User.create(user);\n    }\n\n    public login(loginRequestee: LoginRequest): Promise<User | LoginResponse> {\n        const secret = process.env.JWT_SECRET;\n        return User.findOne({\n            where: {\n                [Op.or]: [\n                    { userName: loginRequestee.userName },\n                    { email: loginRequestee.userName }\n                ]\n            }\n        })\n        .then(user => {\n            if (bcrypt.compareSync(loginRequestee.password, user.password)) {// compares the hash with the password from the lognin request\n                const token: string = jwt.sign({ userName: user.userName, userId: user.id, isAdmin: user.isAdmin }, secret, { expiresIn: '2h' });\n                return Promise.resolve({ user, token });\n            } else {\n                return Promise.reject({ message: 'not authorized' });\n            }\n        })\n        .catch(err => Promise.reject({ message: err }));\n    }\n\n    public getAll(): Promise<User[]> {\n        return User.findAll();\n    }\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9de2ec2a0b940774d2dc6392394ea38d3bc4026a"},"/app/backend/src/middlewares/checkAuth.ts":{"path":"/app/backend/src/middlewares/checkAuth.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"4":{"start":{"line":7,"column":23},"end":{"line":7,"column":63}},"5":{"start":{"line":9,"column":4},"end":{"line":21,"column":5}},"6":{"start":{"line":10,"column":23},"end":{"line":10,"column":45}},"7":{"start":{"line":11,"column":22},"end":{"line":11,"column":61}},"8":{"start":{"line":12,"column":24},"end":{"line":12,"column":68}},"9":{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},"10":{"start":{"line":14,"column":12},"end":{"line":14,"column":62}},"11":{"start":{"line":16,"column":8},"end":{"line":16,"column":27}},"12":{"start":{"line":17,"column":8},"end":{"line":17,"column":15}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":58}},"14":{"start":{"line":23,"column":0},"end":{"line":23,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"verifyToken","decl":{"start":{"line":8,"column":9},"end":{"line":8,"column":20}},"loc":{"start":{"line":8,"column":37},"end":{"line":22,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},"type":"if","locations":[{"start":{"line":13,"column":8},"end":{"line":15,"column":9}},{"start":{"line":13,"column":8},"end":{"line":15,"column":9}}],"line":13}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"f":{"0":1,"1":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/middlewares/checkAuth.ts","sources":["/app/backend/src/middlewares/checkAuth.ts"],"names":[],"mappings":";;;;;;AAAA,gEAA+B;AAO/B,SAAgB,WAAW,CAAC,GAAiB,EAAE,GAAa,EAAE,IAAS;IACnE,IAAI;QAEA,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;QAEtC,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACtD,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAC1C,IAAI,OAAO,IAAI,IAAI,EAAE;YACjB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;SACrD;QAED,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC;QACnB,IAAI,EAAE,CAAC;KACV;IAAC,OAAO,GAAG,EAAE;QACV,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;KACrD;AACL,CAAC;AAhBD,kCAgBC","sourcesContent":["import jwt from 'jsonwebtoken';\nimport { Request, Response } from 'express';\n\nexport interface IAuthRequest extends Request {\n    user: any;\n}\n// this way you can just define a function and export it instead of a whole class\nexport function verifyToken(req: IAuthRequest, res: Response, next: any) {\n    try {\n        // get secret key from environment (defined in nodemon.json)\n        const secret = process.env.JWT_SECRET;\n        // since the Authorizationheader consists of \"Bearer <token>\" where <token> is a JWT token\n        const token = req.headers.authorization.split(' ')[1];\n        const decoded = jwt.verify(token, secret);\n        if (decoded == null) {\n            res.status(403).send({ message: 'Unauthorized' });\n        }\n        // adds the field \"tokenPayload\" to the request enabling following functions to use data from the token\n        req.user = decoded;\n        next();\n    } catch (err) {\n        res.status(403).send({ message: 'Unauthorized' });\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"78e8f30a9f1769a1365899beeb1646800d9ccb85"},"/app/backend/src/middlewares/checkPasswordStrength.ts":{"path":"/app/backend/src/middlewares/checkPasswordStrength.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"2":{"start":{"line":5,"column":21},"end":{"line":5,"column":38}},"3":{"start":{"line":6,"column":32},"end":{"line":6,"column":41}},"4":{"start":{"line":7,"column":32},"end":{"line":7,"column":41}},"5":{"start":{"line":8,"column":29},"end":{"line":8,"column":38}},"6":{"start":{"line":9,"column":30},"end":{"line":9,"column":70}},"7":{"start":{"line":10,"column":4},"end":{"line":21,"column":5}},"8":{"start":{"line":14,"column":8},"end":{"line":17,"column":11}},"9":{"start":{"line":20,"column":8},"end":{"line":20,"column":15}},"10":{"start":{"line":23,"column":0},"end":{"line":23,"column":54}}},"fnMap":{"0":{"name":"checkPasswordStrength","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":30}},"loc":{"start":{"line":4,"column":47},"end":{"line":22,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":10,"column":4},"end":{"line":21,"column":5}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":21,"column":5}},{"start":{"line":10,"column":4},"end":{"line":21,"column":5}}],"line":10},"1":{"loc":{"start":{"line":10,"column":8},"end":{"line":13,"column":50}},"type":"binary-expr","locations":[{"start":{"line":10,"column":8},"end":{"line":10,"column":52}},{"start":{"line":11,"column":8},"end":{"line":11,"column":52}},{"start":{"line":12,"column":8},"end":{"line":12,"column":49}},{"start":{"line":13,"column":8},"end":{"line":13,"column":50}}],"line":10}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":1},"f":{"0":1},"b":{"0":[0,1],"1":[1,1,1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/middlewares/checkPasswordStrength.ts","sources":["/app/backend/src/middlewares/checkPasswordStrength.ts"],"names":[],"mappings":";;;AAEA,SAAgB,qBAAqB,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;IACnF,MAAM,QAAQ,GAAG,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC;IAEnC,MAAM,mBAAmB,GAAG,SAAS,CAAC;IACtC,MAAM,mBAAmB,GAAG,SAAS,CAAC;IACtC,MAAM,gBAAgB,GAAG,SAAS,CAAC;IACnC,MAAM,iBAAiB,GAAG,wCAAwC,CAAC;IACnE,IACE,mBAAmB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK;QAC5C,mBAAmB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK;QAC5C,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK;QACzC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,EAC1C;QACA,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YACnB,gBAAgB,EACd,sDAAsD;gBACtD,wEAAwE;SAC3E,CAAC,CAAC;KACJ;SAAM;QACL,IAAI,EAAE,CAAC;KACR;AACH,CAAC;AArBD,sDAqBC","sourcesContent":["import { Request, Response, NextFunction } from 'express';\n\nexport function checkPasswordStrength(req: Request, res: Response, next: NextFunction) {\n  const password = req.body.password;\n\n  const upperCaseCharacters = /[A-Z]+/g;\n  const lowerCaseCharacters = /[a-z]+/g;\n  const numberCharacters = /[0-9]+/g;\n  const specialCharacters = /[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]+/;\n  if (\n    upperCaseCharacters.test(password) === false ||\n    lowerCaseCharacters.test(password) === false ||\n    numberCharacters.test(password) === false ||\n    specialCharacters.test(password) === false\n  ) {\n    res.status(400).send({\n      passwordStrength:\n        'Password must contain at least two of the following:' +\n        ' numbers, lowercase letters, uppercase letters, or special characters.',\n    });\n  } else {\n    next();\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bf75c8c4b487abc11a38c0c931ef70ec2c5bdb48"},"/app/backend/src/controllers/secured.controller.ts":{"path":"/app/backend/src/controllers/secured.controller.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":35}},"4":{"start":{"line":7,"column":18},"end":{"line":7,"column":53}},"5":{"start":{"line":8,"column":20},"end":{"line":8,"column":55}},"6":{"start":{"line":9,"column":24},"end":{"line":9,"column":50}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"8":{"start":{"line":11,"column":0},"end":{"line":13,"column":3}},"9":{"start":{"line":12,"column":4},"end":{"line":12,"column":103}},"10":{"start":{"line":14,"column":0},"end":{"line":14,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":25},"end":{"line":11,"column":26}},"loc":{"start":{"line":11,"column":39},"end":{"line":13,"column":1}},"line":11}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1},"f":{"0":1,"1":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/controllers/secured.controller.ts","sources":["/app/backend/src/controllers/secured.controller.ts"],"names":[],"mappings":";;;;;;AAAA,sDAA6D;AAC7D,wDAAqE;AAErE,MAAM,eAAe,GAAW,iBAAO,CAAC,MAAM,EAAE,CAAC;AAGjD,eAAe,CAAC,GAAG,CAAC,uBAAW,CAAC,CAAC;AAEjC,eAAe,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAiB,EAAE,GAAa,EAAE,EAAE;IAE1D,GAAG,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,gCAAgC,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAG,YAAY,EAAE,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;AACvG,CAAC,CAAC,CAAC;AAEU,QAAA,iBAAiB,GAAW,eAAe,CAAC","sourcesContent":["import express, { Router, Request, Response } from 'express';\nimport { verifyToken, IAuthRequest } from '../middlewares/checkAuth';\n\nconst securedEndpoint: Router = express.Router();\n\n// This is a middleware function that validates the token in the authorization-header for any incoming request\nsecuredEndpoint.use(verifyToken);\n\nsecuredEndpoint.get('/', (req: IAuthRequest, res: Response) => {\n    // for demonstration purposes the content of the token and a message is returned\n    res.send({message: `This is a secured  Endpoint, ${req.user.userName}` , decodedToken: req.user });\n});\n\nexport const SecuredController: Router = securedEndpoint;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"58ab8750bb630e6ceb1f015d7d17c8650bf310d9"},"/app/backend/src/controllers/products.controller.ts":{"path":"/app/backend/src/controllers/products.controller.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":35}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":26},"end":{"line":17,"column":64}},"18":{"start":{"line":18,"column":20},"end":{"line":18,"column":55}},"19":{"start":{"line":19,"column":23},"end":{"line":19,"column":61}},"20":{"start":{"line":20,"column":36},"end":{"line":20,"column":87}},"21":{"start":{"line":21,"column":26},"end":{"line":21,"column":52}},"22":{"start":{"line":22,"column":23},"end":{"line":22,"column":61}},"23":{"start":{"line":23,"column":0},"end":{"line":32,"column":4}},"24":{"start":{"line":23,"column":73},"end":{"line":32,"column":2}},"25":{"start":{"line":24,"column":4},"end":{"line":31,"column":5}},"26":{"start":{"line":25,"column":23},"end":{"line":25,"column":38}},"27":{"start":{"line":26,"column":24},"end":{"line":26,"column":69}},"28":{"start":{"line":27,"column":8},"end":{"line":27,"column":26}},"29":{"start":{"line":30,"column":8},"end":{"line":30,"column":18}},"30":{"start":{"line":33,"column":0},"end":{"line":42,"column":4}},"31":{"start":{"line":33,"column":119},"end":{"line":42,"column":2}},"32":{"start":{"line":34,"column":4},"end":{"line":41,"column":5}},"33":{"start":{"line":35,"column":26},"end":{"line":35,"column":46}},"34":{"start":{"line":36,"column":24},"end":{"line":36,"column":63}},"35":{"start":{"line":37,"column":8},"end":{"line":37,"column":26}},"36":{"start":{"line":40,"column":8},"end":{"line":40,"column":25}},"37":{"start":{"line":43,"column":0},"end":{"line":51,"column":4}},"38":{"start":{"line":43,"column":48},"end":{"line":51,"column":2}},"39":{"start":{"line":44,"column":4},"end":{"line":50,"column":5}},"40":{"start":{"line":45,"column":25},"end":{"line":45,"column":54}},"41":{"start":{"line":46,"column":8},"end":{"line":46,"column":27}},"42":{"start":{"line":49,"column":8},"end":{"line":49,"column":18}},"43":{"start":{"line":52,"column":0},"end":{"line":60,"column":4}},"44":{"start":{"line":52,"column":74},"end":{"line":60,"column":2}},"45":{"start":{"line":53,"column":4},"end":{"line":59,"column":5}},"46":{"start":{"line":54,"column":25},"end":{"line":54,"column":76}},"47":{"start":{"line":55,"column":8},"end":{"line":55,"column":27}},"48":{"start":{"line":58,"column":8},"end":{"line":58,"column":18}},"49":{"start":{"line":61,"column":0},"end":{"line":69,"column":4}},"50":{"start":{"line":61,"column":109},"end":{"line":69,"column":2}},"51":{"start":{"line":62,"column":4},"end":{"line":68,"column":5}},"52":{"start":{"line":63,"column":25},"end":{"line":63,"column":63}},"53":{"start":{"line":64,"column":8},"end":{"line":64,"column":27}},"54":{"start":{"line":67,"column":8},"end":{"line":67,"column":18}},"55":{"start":{"line":70,"column":0},"end":{"line":79,"column":4}},"56":{"start":{"line":70,"column":140},"end":{"line":79,"column":2}},"57":{"start":{"line":71,"column":4},"end":{"line":78,"column":5}},"58":{"start":{"line":72,"column":26},"end":{"line":72,"column":46}},"59":{"start":{"line":73,"column":24},"end":{"line":73,"column":62}},"60":{"start":{"line":74,"column":8},"end":{"line":74,"column":26}},"61":{"start":{"line":77,"column":8},"end":{"line":77,"column":18}},"62":{"start":{"line":80,"column":0},"end":{"line":88,"column":4}},"63":{"start":{"line":80,"column":57},"end":{"line":88,"column":2}},"64":{"start":{"line":81,"column":4},"end":{"line":87,"column":5}},"65":{"start":{"line":82,"column":25},"end":{"line":82,"column":71}},"66":{"start":{"line":83,"column":8},"end":{"line":83,"column":27}},"67":{"start":{"line":86,"column":8},"end":{"line":86,"column":18}},"68":{"start":{"line":89,"column":0},"end":{"line":98,"column":4}},"69":{"start":{"line":89,"column":137},"end":{"line":98,"column":2}},"70":{"start":{"line":90,"column":4},"end":{"line":97,"column":5}},"71":{"start":{"line":91,"column":26},"end":{"line":91,"column":46}},"72":{"start":{"line":92,"column":24},"end":{"line":92,"column":72}},"73":{"start":{"line":93,"column":8},"end":{"line":93,"column":26}},"74":{"start":{"line":96,"column":8},"end":{"line":96,"column":25}},"75":{"start":{"line":99,"column":0},"end":{"line":99,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":23,"column":53},"end":{"line":23,"column":54}},"loc":{"start":{"line":23,"column":73},"end":{"line":32,"column":2}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":23,"column":107},"end":{"line":23,"column":108}},"loc":{"start":{"line":23,"column":120},"end":{"line":32,"column":1}},"line":23},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":99},"end":{"line":33,"column":100}},"loc":{"start":{"line":33,"column":119},"end":{"line":42,"column":2}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":33,"column":153},"end":{"line":33,"column":154}},"loc":{"start":{"line":33,"column":166},"end":{"line":42,"column":1}},"line":33},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":27},"end":{"line":43,"column":28}},"loc":{"start":{"line":43,"column":48},"end":{"line":51,"column":2}},"line":43},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":82},"end":{"line":43,"column":83}},"loc":{"start":{"line":43,"column":95},"end":{"line":51,"column":1}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":52,"column":54},"end":{"line":52,"column":55}},"loc":{"start":{"line":52,"column":74},"end":{"line":60,"column":2}},"line":52},"15":{"name":"(anonymous_15)","decl":{"start":{"line":52,"column":108},"end":{"line":52,"column":109}},"loc":{"start":{"line":52,"column":121},"end":{"line":60,"column":1}},"line":52},"16":{"name":"(anonymous_16)","decl":{"start":{"line":61,"column":88},"end":{"line":61,"column":89}},"loc":{"start":{"line":61,"column":109},"end":{"line":69,"column":2}},"line":61},"17":{"name":"(anonymous_17)","decl":{"start":{"line":61,"column":143},"end":{"line":61,"column":144}},"loc":{"start":{"line":61,"column":156},"end":{"line":69,"column":1}},"line":61},"18":{"name":"(anonymous_18)","decl":{"start":{"line":70,"column":120},"end":{"line":70,"column":121}},"loc":{"start":{"line":70,"column":140},"end":{"line":79,"column":2}},"line":70},"19":{"name":"(anonymous_19)","decl":{"start":{"line":70,"column":174},"end":{"line":70,"column":175}},"loc":{"start":{"line":70,"column":187},"end":{"line":79,"column":1}},"line":70},"20":{"name":"(anonymous_20)","decl":{"start":{"line":80,"column":37},"end":{"line":80,"column":38}},"loc":{"start":{"line":80,"column":57},"end":{"line":88,"column":2}},"line":80},"21":{"name":"(anonymous_21)","decl":{"start":{"line":80,"column":91},"end":{"line":80,"column":92}},"loc":{"start":{"line":80,"column":104},"end":{"line":88,"column":1}},"line":80},"22":{"name":"(anonymous_22)","decl":{"start":{"line":89,"column":117},"end":{"line":89,"column":118}},"loc":{"start":{"line":89,"column":137},"end":{"line":98,"column":2}},"line":89},"23":{"name":"(anonymous_23)","decl":{"start":{"line":89,"column":171},"end":{"line":89,"column":172}},"loc":{"start":{"line":89,"column":184},"end":{"line":98,"column":1}},"line":89}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,1],"7":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/controllers/products.controller.ts","sources":["/app/backend/src/controllers/products.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,sDAA2E;AAC3E,iEAA6D;AAC7D,wDAAqE;AACrE,8DAA2D;AAC3D,wFAAmF;AAGnF,MAAM,iBAAiB,GAAW,iBAAO,CAAC,MAAM,EAAE,CAAC;AACnD,MAAM,cAAc,GAAG,IAAI,gCAAc,EAAE,CAAC;AAE5C,iBAAiB,CAAC,IAAI,CACpB,GAAG,EACH,uBAAW,EACX,CAAO,GAAiB,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC7D,IAAI;QACF,MAAM,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;QAC/B,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QAC9D,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACnB;IAAC,OAAO,GAAG,EAAE;QACZ,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAGF,iBAAiB,CAAC,GAAG,CACnB,qBAAqB,EACrB,uBAAW,EACX,2BAAY,EACZ,CAAO,GAAiC,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC7E,IAAI;QACF,MAAM,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC;QACvC,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACxD,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACnB;IAAC,OAAO,GAAG,EAAE;QACZ,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;AACH,CAAC,CAAA,CACF,CAAC;AAIF,iBAAiB,CAAC,GAAG,CACnB,GAAG,EACH,CAAO,IAAa,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACzD,IAAI;QACF,MAAM,QAAQ,GAAG,MAAM,cAAc,CAAC,MAAM,EAAE,CAAC;QAC/C,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACpB;IAAC,OAAO,GAAG,EAAE;QACZ,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAGF,iBAAiB,CAAC,GAAG,CACnB,KAAK,EACL,uBAAW,EACX,CAAO,GAAiB,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC7D,IAAI;QACF,MAAM,QAAQ,GAAG,MAAM,cAAc,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACrE,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACpB;IAAC,OAAO,GAAG,EAAE;QACZ,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAEF,iBAAiB,CAAC,GAAG,CACnB,UAAU,EACV,uBAAW,EACX,2BAAY,EACZ,CAAO,IAAa,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACzD,IAAI;QACF,MAAM,QAAQ,GAAG,MAAM,cAAc,CAAC,eAAe,EAAE,CAAC;QACxD,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACpB;IAAC,OAAO,GAAG,EAAG;QACb,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAEF,iBAAiB,CAAC,MAAM,CACtB,aAAa,EACb,uBAAW,EACX,qDAAyB,EACzB,CAAO,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACxD,IAAI;QACF,MAAM,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC;QACvC,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACvD,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACnB;IAAC,OAAO,GAAG,EAAE;QACZ,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAEF,iBAAiB,CAAC,GAAG,CACnB,aAAa,EACb,CAAO,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACxD,IAAI;QACF,MAAM,QAAQ,GAAG,MAAM,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAChE,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACpB;IAAC,OAAO,GAAG,EAAE;QACZ,IAAI,CAAC,GAAG,CAAC,CAAC;KACX;AACH,CAAC,CAAA,CACF,CAAC;AAGF,iBAAiB,CAAC,GAAG,CACnB,aAAa,EACb,uBAAW,EACX,qDAAyB,EACzB,CAAO,GAAiC,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC7E,IAAI;QACF,MAAM,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC;QACvC,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;QACjE,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACnB;IAAC,OAAO,GAAG,EAAE;QACZ,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;AACH,CAAC,CAAA,CACF,CAAC;AAGW,QAAA,iBAAiB,GAAW,iBAAiB,CAAC","sourcesContent":["import express, { Router, Request, Response, NextFunction } from 'express';\nimport { ProductService } from '../services/product.service';\nimport { verifyToken, IAuthRequest } from '../middlewares/checkAuth';\nimport { checkIsAdmin } from '../middlewares/checkIsAdmin';\nimport {checkProductAuthorization} from '../middlewares/checkProductAuthorization';\n\n\nconst productController: Router = express.Router();\nconst productService = new ProductService();\n\nproductController.post(\n  '/',\n  verifyToken,\n  async (req: IAuthRequest, res: Response, next: NextFunction) => {\n    try {\n      const userId = req.user.userId;\n      const product = await productService.create(req.body, userId);\n      res.send(product);\n    } catch (err) {\n      next(err);\n    }\n  }\n);\n\n\nproductController.put(\n  '/:productId/approve',\n  verifyToken,\n  checkIsAdmin,\n  async (req: Request<{productId: string}>, res: Response, next: NextFunction) => {\n    try {\n      const productId = req.params.productId;\n      const product = await productService.approve(productId);\n      res.send(product);\n    } catch (err) {\n      return next(err);\n    }\n  }\n);\n\n\n\nproductController.get(\n  '/', // you can add middleware on specific requests like that\n  async (_req: Request, res: Response, next: NextFunction) => {\n    try {\n      const products = await productService.getAll();\n      res.send(products);\n    } catch (err) {\n      next(err);\n    }\n  }\n);\n\n\nproductController.get(\n  '/me', // you can add middleware on specific requests like that\n  verifyToken,\n  async (req: IAuthRequest, res: Response, next: NextFunction) => {\n    try {\n      const products = await productService.getMyProducts(req.user.userId);\n      res.send(products);\n    } catch (err) {\n      next(err);\n    }\n  }\n);\n\nproductController.get(\n  '/pending', // you can add middleware on specific requests like that\n  verifyToken,\n  checkIsAdmin,\n  async (_req: Request, res: Response, next: NextFunction) => {\n    try {\n      const products = await productService.getToBeApproved();\n      res.send(products);\n    } catch (err)  {\n      next(err);\n    }\n  }\n);\n\nproductController.delete(\n  '/:productId',\n  verifyToken,\n  checkProductAuthorization,\n  async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const productId = req.params.productId;\n      const product = await productService.delete(productId);\n      res.send(product);\n    } catch (err) {\n      next(err);\n    }\n  }\n);\n\nproductController.get(\n  '/:productId', // you can add middleware on specific requests like that\n  async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const products = await productService.get(req.params.productId);\n      res.send(products);\n    } catch (err) {\n      next(err);\n    }\n  }\n);\n\n\nproductController.put(\n  '/:productId',\n  verifyToken,\n  checkProductAuthorization,\n  async (req: Request<{productId: string}>, res: Response, next: NextFunction) => {\n    try {\n      const productId = req.params.productId;\n      const product = await productService.update(productId, req.body);\n      res.send(product);\n    } catch (err) {\n      return next(err);\n    }\n  }\n);\n\n\nexport const ProductController: Router = productController;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a0c31b20a57fa44ac9df61a7811c02b7e2612782"},"/app/backend/src/services/product.service.ts":{"path":"/app/backend/src/services/product.service.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"14":{"start":{"line":13,"column":24},"end":{"line":13,"column":58}},"15":{"start":{"line":14,"column":22},"end":{"line":14,"column":54}},"16":{"start":{"line":17,"column":8},"end":{"line":23,"column":11}},"17":{"start":{"line":18,"column":12},"end":{"line":22,"column":15}},"18":{"start":{"line":26,"column":8},"end":{"line":30,"column":11}},"19":{"start":{"line":27,"column":12},"end":{"line":27,"column":36}},"20":{"start":{"line":28,"column":12},"end":{"line":28,"column":34}},"21":{"start":{"line":29,"column":12},"end":{"line":29,"column":59}},"22":{"start":{"line":33,"column":8},"end":{"line":44,"column":11}},"23":{"start":{"line":34,"column":12},"end":{"line":34,"column":37}},"24":{"start":{"line":35,"column":12},"end":{"line":35,"column":41}},"25":{"start":{"line":36,"column":12},"end":{"line":36,"column":46}},"26":{"start":{"line":37,"column":12},"end":{"line":37,"column":40}},"27":{"start":{"line":38,"column":12},"end":{"line":38,"column":46}},"28":{"start":{"line":39,"column":12},"end":{"line":43,"column":15}},"29":{"start":{"line":47,"column":8},"end":{"line":51,"column":11}},"30":{"start":{"line":48,"column":28},"end":{"line":48,"column":77}},"31":{"start":{"line":49,"column":12},"end":{"line":49,"column":40}},"32":{"start":{"line":50,"column":12},"end":{"line":50,"column":34}},"33":{"start":{"line":54,"column":8},"end":{"line":62,"column":11}},"34":{"start":{"line":55,"column":28},"end":{"line":55,"column":77}},"35":{"start":{"line":56,"column":12},"end":{"line":61,"column":13}},"36":{"start":{"line":57,"column":16},"end":{"line":57,"column":41}},"37":{"start":{"line":60,"column":16},"end":{"line":60,"column":79}},"38":{"start":{"line":65,"column":8},"end":{"line":72,"column":11}},"39":{"start":{"line":66,"column":12},"end":{"line":71,"column":15}},"40":{"start":{"line":75,"column":8},"end":{"line":82,"column":11}},"41":{"start":{"line":76,"column":12},"end":{"line":81,"column":15}},"42":{"start":{"line":85,"column":8},"end":{"line":92,"column":11}},"43":{"start":{"line":86,"column":12},"end":{"line":91,"column":15}},"44":{"start":{"line":95,"column":0},"end":{"line":95,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":19},"end":{"line":24,"column":5}},"line":16},"8":{"name":"(anonymous_8)","decl":{"start":{"line":17,"column":47},"end":{"line":17,"column":48}},"loc":{"start":{"line":17,"column":60},"end":{"line":23,"column":9}},"line":17},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":28},"end":{"line":31,"column":5}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":47},"end":{"line":26,"column":48}},"loc":{"start":{"line":26,"column":60},"end":{"line":30,"column":9}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":38},"end":{"line":45,"column":5}},"line":32},"12":{"name":"(anonymous_12)","decl":{"start":{"line":33,"column":47},"end":{"line":33,"column":48}},"loc":{"start":{"line":33,"column":60},"end":{"line":44,"column":9}},"line":33},"13":{"name":"(anonymous_13)","decl":{"start":{"line":46,"column":4},"end":{"line":46,"column":5}},"loc":{"start":{"line":46,"column":23},"end":{"line":52,"column":5}},"line":46},"14":{"name":"(anonymous_14)","decl":{"start":{"line":47,"column":47},"end":{"line":47,"column":48}},"loc":{"start":{"line":47,"column":60},"end":{"line":51,"column":9}},"line":47},"15":{"name":"(anonymous_15)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":22},"end":{"line":63,"column":5}},"line":53},"16":{"name":"(anonymous_16)","decl":{"start":{"line":54,"column":47},"end":{"line":54,"column":48}},"loc":{"start":{"line":54,"column":60},"end":{"line":62,"column":9}},"line":54},"17":{"name":"(anonymous_17)","decl":{"start":{"line":64,"column":4},"end":{"line":64,"column":5}},"loc":{"start":{"line":64,"column":13},"end":{"line":73,"column":5}},"line":64},"18":{"name":"(anonymous_18)","decl":{"start":{"line":65,"column":47},"end":{"line":65,"column":48}},"loc":{"start":{"line":65,"column":60},"end":{"line":72,"column":9}},"line":65},"19":{"name":"(anonymous_19)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":26},"end":{"line":83,"column":5}},"line":74},"20":{"name":"(anonymous_20)","decl":{"start":{"line":75,"column":47},"end":{"line":75,"column":48}},"loc":{"start":{"line":75,"column":60},"end":{"line":82,"column":9}},"line":75},"21":{"name":"(anonymous_21)","decl":{"start":{"line":84,"column":4},"end":{"line":84,"column":5}},"loc":{"start":{"line":84,"column":22},"end":{"line":93,"column":5}},"line":84},"22":{"name":"(anonymous_22)","decl":{"start":{"line":85,"column":47},"end":{"line":85,"column":48}},"loc":{"start":{"line":85,"column":60},"end":{"line":92,"column":9}},"line":85}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":56,"column":12},"end":{"line":61,"column":13}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":61,"column":13}},{"start":{"line":56,"column":12},"end":{"line":61,"column":13}}],"line":56}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/services/product.service.ts","sources":["/app/backend/src/services/product.service.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,2DAIiC;AACjC,uDAA4C;AAE5C,MAAa,cAAc;IACZ,GAAG,CAAC,SAAiB;;YAChC,OAAO,uBAAO,CAAC,OAAO,CAAC;gBACrB,KAAK,EAAE;oBACL,EAAE,EAAE,SAAS;iBACd;aACF,CAAC,CAAC;QACL,CAAC;KAAA;IAEY,MAAM,CAAC,OAAkC,EAAE,MAAc;;YACpE,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;YACxB,OAAO,OAAO,CAAC,MAAM,CAAC;YACtB,OAAO,uBAAO,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC;KAAA;IAEY,MAAM,CAAC,SAAiB,EAAE,cAAiC;;YACtE,OAAO,cAAc,CAAC,EAAE,CAAC;YACzB,OAAO,cAAc,CAAC,MAAM,CAAC;YAC7B,cAAc,CAAC,MAAM,GAAG,SAAS,CAAC;YAClC,OAAO,cAAc,CAAC,KAAK,CAAC;YAC5B,OAAO,cAAc,CAAC,WAAW,CAAC;YAElC,OAAO,uBAAO,CAAC,MAAM,CAAC,cAAc,EAAE;gBACpC,KAAK,EAAE;oBACL,EAAE,EAAE,SAAS;iBACd;aACF,CAAC,CAAC;QACL,CAAC;KAAA;IAEY,OAAO,CAAC,SAAiB;;YACpC,MAAM,OAAO,GAAG,MAAM,uBAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YAClD,OAAO,CAAC,MAAM,GAAG,UAAU,CAAC;YAC5B,OAAO,OAAO,CAAC,IAAI,EAAE,CAAC;QACxB,CAAC;KAAA;IAEY,MAAM,CAAC,SAAiB;;YACnC,MAAM,OAAO,GAAG,MAAM,uBAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YAClD,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gBACpD,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;aAC1B;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;aAChE;QACH,CAAC;KAAA;IAEY,MAAM;;YACjB,OAAO,uBAAO,CAAC,OAAO,CAAC;gBACrB,KAAK,EAAE;oBACL,MAAM,EAAE,UAAU;iBACnB;gBACD,OAAO,EAAE,mBAAY;aACtB,CAAC,CAAC;QACL,CAAC;KAAA;IAEY,aAAa,CAAC,MAAc;;YACvC,OAAO,uBAAO,CAAC,OAAO,CAAC;gBACrB,KAAK,EAAE;oBACL,MAAM,EAAE,MAAM;iBACf;gBACD,OAAO,EAAE,mBAAY;aACtB,CAAC,CAAC;QACL,CAAC;KAAA;IAEY,eAAe;;YAC1B,OAAO,uBAAO,CAAC,OAAO,CAAC;gBACrB,KAAK,EAAE;oBACL,MAAM,EAAE,SAAS;iBAClB;gBACD,OAAO,EAAE,mBAAY;aACtB,CAAC,CAAC;QACL,CAAC;KAAA;CACF;AAtED,wCAsEC","sourcesContent":["import {\n  Product,\n  ProductCreationAttributes,\n  ProductAttributes,\n} from '../models/product.model';\nimport {Photo} from '../models/photo.model';\n\nexport class ProductService {\n  public async get(productId: string) {\n    return Product.findOne({\n      where: {\n        id: productId,\n      },\n    });\n  }\n\n  public async create(product: ProductCreationAttributes, userId: number) {\n    product.UserId = userId;\n    delete product.status;\n    return Product.create(product);\n  }\n\n  public async update(productId: string, productChanges: ProductAttributes) {\n    delete productChanges.id;\n    delete productChanges.UserId;\n    productChanges.status = 'pending';\n    delete productChanges.title;\n    delete productChanges.productType;\n\n    return Product.update(productChanges, {\n      where: {\n        id: productId,\n      },\n    });\n  }\n\n  public async approve(productId: string): Promise<Product> {\n    const product = await Product.findByPk(productId);\n    product.status = 'approved';\n    return product.save();\n  }\n\n  public async delete(productId: string) {\n    const product = await Product.findByPk(productId);\n    if (['approved', 'pending'].includes(product.status)) {\n      return product.destroy();\n    } else {\n      throw new Error('Referenced Product is not an active product');\n    }\n  }\n\n  public async getAll() {\n    return Product.findAll({\n      where: {\n        status: 'approved',\n      },\n      include: Photo as any\n    });\n  }\n\n  public async getMyProducts(userId: number) {\n    return Product.findAll({\n      where: {\n        UserId: userId,\n      },\n      include: Photo as any\n    });\n  }\n\n  public async getToBeApproved() {\n    return Product.findAll({\n      where: {\n        status: 'pending',\n      },\n      include: Photo as any\n    });\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b5eb9e16b4fc02164c0c43f8cb0d40e5e286347b"},"/app/backend/src/middlewares/checkIsAdmin.ts":{"path":"/app/backend/src/middlewares/checkIsAdmin.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":30}},"2":{"start":{"line":5,"column":4},"end":{"line":12,"column":5}},"3":{"start":{"line":6,"column":8},"end":{"line":8,"column":9}},"4":{"start":{"line":7,"column":12},"end":{"line":7,"column":19}},"5":{"start":{"line":11,"column":8},"end":{"line":11,"column":58}},"6":{"start":{"line":14,"column":0},"end":{"line":14,"column":36}}},"fnMap":{"0":{"name":"checkIsAdmin","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":21}},"loc":{"start":{"line":4,"column":38},"end":{"line":13,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":4},"end":{"line":12,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":12,"column":5}},{"start":{"line":5,"column":4},"end":{"line":12,"column":5}}],"line":5},"1":{"loc":{"start":{"line":6,"column":8},"end":{"line":8,"column":9}},"type":"if","locations":[{"start":{"line":6,"column":8},"end":{"line":8,"column":9}},{"start":{"line":6,"column":8},"end":{"line":8,"column":9}}],"line":6}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":1},"f":{"0":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/middlewares/checkIsAdmin.ts","sources":["/app/backend/src/middlewares/checkIsAdmin.ts"],"names":[],"mappings":";;;AAIA,SAAgB,YAAY,CAAC,GAAiB,EAAE,GAAa,EAAE,IAAkB;IAC7E,IAAI,GAAG,CAAC,IAAI,EAAE;QACV,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE;YAClB,IAAI,EAAE,CAAC;SACV;KACJ;SAAM;QACH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;KACrD;AACL,CAAC;AARD,oCAQC","sourcesContent":["import { Response, NextFunction } from 'express';\nimport {IAuthRequest} from './checkAuth';\n\n// this way you can just define a function and export it instead of a whole class\nexport function checkIsAdmin(req: IAuthRequest, res: Response, next: NextFunction) {\n    if (req.user) {\n        if (req.user.isAdmin) {\n            next();\n        }\n    } else {\n        res.status(403).send({ message: 'Unauthorized' });\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"79f0b39051bb75059347177da0e73458b9458988"},"/app/backend/src/middlewares/checkProductAuthorization.ts":{"path":"/app/backend/src/middlewares/checkProductAuthorization.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":43}},"14":{"start":{"line":13,"column":24},"end":{"line":13,"column":58}},"15":{"start":{"line":15,"column":4},"end":{"line":41,"column":7}},"16":{"start":{"line":16,"column":8},"end":{"line":40,"column":9}},"17":{"start":{"line":17,"column":12},"end":{"line":19,"column":13}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":76}},"19":{"start":{"line":20,"column":12},"end":{"line":36,"column":13}},"20":{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},"21":{"start":{"line":24,"column":32},"end":{"line":29,"column":18}},"22":{"start":{"line":30,"column":16},"end":{"line":35,"column":17}},"23":{"start":{"line":31,"column":20},"end":{"line":31,"column":27}},"24":{"start":{"line":34,"column":20},"end":{"line":34,"column":70}},"25":{"start":{"line":39,"column":12},"end":{"line":39,"column":22}},"26":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"checkProductAuthorization","decl":{"start":{"line":14,"column":9},"end":{"line":14,"column":34}},"loc":{"start":{"line":14,"column":51},"end":{"line":42,"column":1}},"line":14},"8":{"name":"(anonymous_8)","decl":{"start":{"line":15,"column":43},"end":{"line":15,"column":44}},"loc":{"start":{"line":15,"column":56},"end":{"line":41,"column":5}},"line":15}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":17,"column":12},"end":{"line":19,"column":13}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":19,"column":13}},{"start":{"line":17,"column":12},"end":{"line":19,"column":13}}],"line":17},"6":{"loc":{"start":{"line":20,"column":12},"end":{"line":36,"column":13}},"type":"if","locations":[{"start":{"line":20,"column":12},"end":{"line":36,"column":13}},{"start":{"line":20,"column":12},"end":{"line":36,"column":13}}],"line":20},"7":{"loc":{"start":{"line":30,"column":16},"end":{"line":35,"column":17}},"type":"if","locations":[{"start":{"line":30,"column":16},"end":{"line":35,"column":17}},{"start":{"line":30,"column":16},"end":{"line":35,"column":17}}],"line":30}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/middlewares/checkProductAuthorization.ts","sources":["/app/backend/src/middlewares/checkProductAuthorization.ts"],"names":[],"mappings":";;;;;;;;;;;;AAEA,2DAAgD;AAEhD,SAAsB,yBAAyB,CAAC,GAAiB,EAAE,GAAa,EAAE,IAAkB;;QAChG,IAAI;YACA,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;gBACX,OAAO,CAAC,KAAK,CAAC,4CAA4C,CAAC,CAAC;aAC/D;YACD,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE;gBAClB,IAAI,EAAE,CAAC;aACV;iBAAM;gBACH,MAAM,OAAO,GAAG,MAAM,uBAAO,CAAC,OAAO,CAAC;oBAClC,KAAK,EAAE;wBACH,EAAE,EAAE,GAAG,CAAC,MAAM,CAAC,SAAS;wBACxB,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM;qBAC1B;iBACJ,CAAC,CAAC;gBACH,IAAI,OAAO,EAAE;oBACT,IAAI,EAAE,CAAC;iBACV;qBAAM;oBACH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC,CAAC;iBACrD;aACJ;SACJ;QAAC,OAAO,GAAG,EAAE;YACX,IAAI,CAAC,GAAG,CAAC,CAAC;SACZ;IACL,CAAC;CAAA;AAvBD,8DAuBC","sourcesContent":["import { Response, NextFunction } from 'express';\nimport {IAuthRequest} from './checkAuth';\nimport {Product} from '../models/product.model';\n\nexport async function checkProductAuthorization(req: IAuthRequest, res: Response, next: NextFunction) {\n    try {\n        if (!req.user) {\n            console.error('need to call verifyToken before using this');\n        }\n        if (req.user.isAdmin) {\n            next();\n        } else {\n            const product = await Product.findOne({\n                where: {\n                    id: req.params.productId,\n                    UserId: req.user.userId\n                }\n            });\n            if (product) {\n                next();\n            } else {\n                res.status(403).send({ message: 'Unauthorized' });\n            }\n        }\n    } catch (err) {\n       next(err);\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7daa7c33780720c992b5493ca0f3d24349adb87d"},"/app/backend/src/controllers/photo.controller.ts":{"path":"/app/backend/src/controllers/photo.controller.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":37}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":51}},"19":{"start":{"line":19,"column":20},"end":{"line":19,"column":55}},"20":{"start":{"line":20,"column":36},"end":{"line":20,"column":87}},"21":{"start":{"line":21,"column":24},"end":{"line":21,"column":60}},"22":{"start":{"line":22,"column":15},"end":{"line":22,"column":47}},"23":{"start":{"line":23,"column":15},"end":{"line":25,"column":2}},"24":{"start":{"line":26,"column":24},"end":{"line":26,"column":50}},"25":{"start":{"line":27,"column":0},"end":{"line":44,"column":4}},"26":{"start":{"line":27,"column":163},"end":{"line":44,"column":2}},"27":{"start":{"line":28,"column":4},"end":{"line":43,"column":5}},"28":{"start":{"line":29,"column":22},"end":{"line":29,"column":31}},"29":{"start":{"line":30,"column":31},"end":{"line":37,"column":10}},"30":{"start":{"line":31,"column":26},"end":{"line":35,"column":13}},"31":{"start":{"line":36,"column":12},"end":{"line":36,"column":62}},"32":{"start":{"line":38,"column":8},"end":{"line":38,"column":42}},"33":{"start":{"line":39,"column":8},"end":{"line":39,"column":35}},"34":{"start":{"line":42,"column":8},"end":{"line":42,"column":25}},"35":{"start":{"line":45,"column":0},"end":{"line":53,"column":4}},"36":{"start":{"line":45,"column":54},"end":{"line":53,"column":2}},"37":{"start":{"line":46,"column":4},"end":{"line":52,"column":5}},"38":{"start":{"line":47,"column":25},"end":{"line":47,"column":44}},"39":{"start":{"line":48,"column":8},"end":{"line":48,"column":102}},"40":{"start":{"line":51,"column":8},"end":{"line":51,"column":18}},"41":{"start":{"line":54,"column":0},"end":{"line":54,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":27,"column":143},"end":{"line":27,"column":144}},"loc":{"start":{"line":27,"column":163},"end":{"line":44,"column":2}},"line":27},"9":{"name":"(anonymous_9)","decl":{"start":{"line":27,"column":197},"end":{"line":27,"column":198}},"loc":{"start":{"line":27,"column":210},"end":{"line":44,"column":1}},"line":27},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":41},"end":{"line":30,"column":42}},"loc":{"start":{"line":30,"column":49},"end":{"line":37,"column":9}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":45,"column":34},"end":{"line":45,"column":35}},"loc":{"start":{"line":45,"column":54},"end":{"line":53,"column":2}},"line":45},"12":{"name":"(anonymous_12)","decl":{"start":{"line":45,"column":88},"end":{"line":45,"column":89}},"loc":{"start":{"line":45,"column":101},"end":{"line":53,"column":1}},"line":45}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":3,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,3],"7":[3,3]},"inputSourceMap":{"version":3,"file":"/app/backend/src/controllers/photo.controller.ts","sources":["/app/backend/src/controllers/photo.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,sDAA2E;AAC3E,sCAAmC;AAEnC,oDAA4B;AAC5B,wDAAmE;AACnE,wFAAmF;AACnF,6DAAuD;AACvD,gDAAwB;AAExB,MAAM,MAAM,GAAG,gBAAM,CAAC;IAClB,IAAI,EAAE,eAAM,CAAC,UAAU;CAC1B,CAAC,CAAC;AAEH,MAAM,eAAe,GAAG,iBAAO,CAAC,MAAM,EAAE,CAAC;AACzC,eAAe,CAAC,IAAI,CAChB,aAAa,EACb,uBAAW,EACX,qDAAyB,EACzB,MAAM,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,EAEzB,CAAO,GAAoB,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC9D,IAAI;QACA,MAAM,KAAK,GAAG,GAAG,CAAC,KAAc,CAAC;QAEjC,MAAM,cAAc,GAAG,KAAK,CAAC,GAAG,CAAE,IAAI,CAAC,EAAE;YACrC,MAAM,KAAK,GAAG;gBACV,MAAM,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM;gBACvB,SAAS,EAAE,GAAG,CAAC,MAAM,CAAC,SAAS;gBAC/B,QAAQ,EAAE,IAAI,CAAC,QAAQ;aAC1B,CAAC;YACF,OAAO,4BAAY,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;QACH,MAAM,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QAClC,GAAG,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;KAC9B;IAAC,OAAO,GAAG,EAAE;QACV,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;KACpB;AACL,CAAC,CAAA,CACJ,CAAC;AACF,eAAe,CAAC,GAAG,CACf,YAAY,EACZ,CAAO,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACtD,IAAI;QACA,MAAM,QAAQ,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC;QACrC,GAAG,CAAC,QAAQ,CAAC,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,eAAM,CAAC,UAAU,GAAG,IAAI,QAAQ,EAAE,CAAC,CAAC,CAAC;KAC9E;IAAC,OAAO,GAAG,EAAE;QACV,IAAI,CAAC,GAAG,CAAC,CAAC;KACb;AACL,CAAC,CAAA,CACJ,CAAC;AAMW,QAAA,eAAe,GAAW,eAAe,CAAC","sourcesContent":["import express, { Request, Response, NextFunction, Router } from 'express';\nimport { config } from '../config';\n\nimport multer from 'multer';\nimport {verifyToken, IAuthRequest} from '../middlewares/checkAuth';\nimport {checkProductAuthorization} from '../middlewares/checkProductAuthorization';\nimport {photoService} from '../services/photo.service';\nimport path from 'path';\n\nconst upload = multer({\n    dest: config.uploadPath\n});\n\nconst photoController = express.Router();\nphotoController.post(\n    '/:productId',\n    verifyToken,\n    checkProductAuthorization,\n    upload.array('images', 5),\n    // upload.array('images[]', 5),\n    async (req: AuthFileRequest, res: Response, next: NextFunction) => {\n        try {\n            const files = req.files as any[];\n\n            const uploadPromises = files.map( file => {\n                const image = {\n                    UserId: req.user.userId,\n                    ProductId: req.params.productId,\n                    fileName: file.filename\n                };\n                return photoService.create(image);\n            });\n            await Promise.all(uploadPromises);\n            res.send({ sucess: true });\n        } catch (err) {\n            return next(err);\n        }\n    }\n);\nphotoController.get(\n    '/:fileName',\n    async (req: Request, res: Response, next: NextFunction) => {\n        try {\n            const fileName = req.params.fileName;\n            res.sendFile(path.join(process.cwd(), config.uploadPath + `/${fileName}`));\n        } catch (err) {\n            next(err);\n        }\n    }\n);\n\ninterface AuthFileRequest extends Request, IAuthRequest {\n    files: any;\n}\n\nexport const PhotoController: Router = photoController;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"add7d1bca2c4f0a1faf6bc374b8cde9b6002c891"},"/app/backend/src/config.ts":{"path":"/app/backend/src/config.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":24}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":3}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":5,"column":16},"end":{"line":5,"column":54}},"type":"binary-expr","locations":[{"start":{"line":5,"column":16},"end":{"line":5,"column":39}},{"start":{"line":5,"column":43},"end":{"line":5,"column":54}}],"line":5}},"s":{"0":1,"1":1,"2":1},"f":{},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/config.ts","sources":["/app/backend/src/config.ts"],"names":[],"mappings":";;;AAAa,QAAA,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;IAChC,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,WAAW;CACrD,CAAC,CAAC","sourcesContent":["export const config = Object.freeze({\n    uploadPath: process.env.UPLOAD_PATH || './uploads'\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"21fe54e998a6c55f727d171749d7517c1274ca19"},"/app/backend/src/services/photo.service.ts":{"path":"/app/backend/src/services/photo.service.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":53}},"14":{"start":{"line":13,"column":22},"end":{"line":13,"column":54}},"15":{"start":{"line":16,"column":8},"end":{"line":18,"column":11}},"16":{"start":{"line":17,"column":12},"end":{"line":17,"column":52}},"17":{"start":{"line":21,"column":8},"end":{"line":28,"column":11}},"18":{"start":{"line":22,"column":26},"end":{"line":26,"column":14}},"19":{"start":{"line":27,"column":12},"end":{"line":27,"column":34}},"20":{"start":{"line":31,"column":0},"end":{"line":31,"column":36}},"21":{"start":{"line":32,"column":0},"end":{"line":32,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":17},"end":{"line":19,"column":5}},"line":15},"8":{"name":"(anonymous_8)","decl":{"start":{"line":16,"column":47},"end":{"line":16,"column":48}},"loc":{"start":{"line":16,"column":60},"end":{"line":18,"column":9}},"line":16},"9":{"name":"(anonymous_9)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":25},"end":{"line":29,"column":5}},"line":20},"10":{"name":"(anonymous_10)","decl":{"start":{"line":21,"column":47},"end":{"line":21,"column":48}},"loc":{"start":{"line":21,"column":60},"end":{"line":28,"column":9}},"line":21}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/app/backend/src/services/photo.service.ts","sources":["/app/backend/src/services/photo.service.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,uDAA8C;AAE9C,MAAa,YAAY;IAEV,MAAM,CAAC,IAAS;;YAC3B,OAAO,mBAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC5B,CAAC;KAAA;IAEY,WAAW,CAAC,OAAe;;YACtC,MAAM,KAAK,GAAG,MAAM,mBAAK,CAAC,OAAO,CAAC;gBAChC,KAAK,EAAE;oBACL,EAAE,EAAE,OAAO;iBACZ;aACF,CAAC,CAAC;YACH,OAAO,KAAK,CAAC,QAAQ,CAAC;QACxB,CAAC;KAAA;CAEF;AAfD,oCAeC;AAEY,QAAA,YAAY,GAAG,IAAI,YAAY,EAAE,CAAC","sourcesContent":["import { Photo } from '../models/photo.model';\n\nexport class PhotoService {\n\n  public async create(file: any) {\n    return Photo.create(file);\n  }\n\n  public async getFilename(photoId: string) {\n    const photo = await Photo.findOne({\n      where: {\n        id: photoId,\n      },\n    });\n    return photo.fileName;\n  }\n\n}\n\nexport const photoService = new PhotoService();\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"397177aa2851063a79f1ea74ccef87b44c6036ea"},"/app/backend/src/controllers/user.controller.spec.ts":{"path":"/app/backend/src/controllers/user.controller.spec.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":15},"end":{"line":12,"column":30}},"14":{"start":{"line":13,"column":20},"end":{"line":13,"column":40}},"15":{"start":{"line":14,"column":16},"end":{"line":14,"column":32}},"16":{"start":{"line":15,"column":26},"end":{"line":15,"column":54}},"17":{"start":{"line":16,"column":17},"end":{"line":16,"column":37}},"18":{"start":{"line":17,"column":12},"end":{"line":17,"column":45}},"19":{"start":{"line":18,"column":0},"end":{"line":44,"column":3}},"20":{"start":{"line":19,"column":4},"end":{"line":43,"column":8}},"21":{"start":{"line":19,"column":29},"end":{"line":43,"column":6}},"22":{"start":{"line":20,"column":25},"end":{"line":34,"column":9}},"23":{"start":{"line":35,"column":8},"end":{"line":35,"column":99}},"24":{"start":{"line":36,"column":20},"end":{"line":40,"column":24}},"25":{"start":{"line":41,"column":8},"end":{"line":41,"column":30}},"26":{"start":{"line":42,"column":8},"end":{"line":42,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":18,"column":30},"end":{"line":18,"column":31}},"loc":{"start":{"line":18,"column":36},"end":{"line":44,"column":1}},"line":18},"8":{"name":"(anonymous_8)","decl":{"start":{"line":19,"column":23},"end":{"line":19,"column":24}},"loc":{"start":{"line":19,"column":29},"end":{"line":43,"column":6}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":63},"end":{"line":19,"column":64}},"loc":{"start":{"line":19,"column":76},"end":{"line":43,"column":5}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":2,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":2,"7":1,"8":1,"9":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,1],"4":[1,1]},"inputSourceMap":{"version":3,"file":"/app/backend/src/controllers/user.controller.spec.ts","sources":["/app/backend/src/controllers/user.controller.spec.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,+BAA8B;AAC9B,yCAA6C;AAC7C,iCAA0B;AAE1B,uDAA8C;AAE9C,sCAAmC;AAEnC,MAAM,GAAG,GAAG,IAAI,eAAM,EAAE,CAAC,SAAS,EAAE,CAAC;AAErC,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE;IACjC,EAAE,CAAC,cAAc,EAAE,GAAS,EAAE;QAE5B,MAAM,QAAQ,GAAG;YACb,EAAE,EAAE,CAAC;YACL,KAAK,EAAE,kBAAkB;YACzB,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,cAAc;YACxB,SAAS,EAAE,IAAI;YACf,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,KAAK;YACd,MAAM,EAAE,OAAO;YACf,KAAK,EAAE,OAAO;YACd,MAAM,EAAE,QAAQ;YAChB,GAAG,EAAE,KAAK;YACV,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE,SAAS;SACrB,CAAC;QACF,YAAI,CAAC,6BAAW,EAAE,UAAU,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;QACjE,MAAM,GAAG,GAAG,MAAM,iBAAO,CAAC,GAAG,CAAC;aAC3B,IAAI,CAAC,oBAAoB,CAAC;aAC1B,IAAI,CACH,QAAQ,CACT;aACA,GAAG,CAAC,QAAQ,EAAE,kBAAkB,CAAC;aACjC,MAAM,CAAC,GAAG,CAAC,CAAC;QACf,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACtB,aAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC;IAC5B,CAAC,CAAA,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { expect } from \"chai\";\nimport { agent as request } from \"supertest\";\nimport {stub} from 'sinon'\n\nimport {userService} from './user.controller';\n\nimport { Server } from '../server';\n\nconst app = new Server().getServer();\n\ndescribe('user can register', () => {\n  it('can register', async () => {\n      \n    const stubUser = {\n        id: 0,\n        email: 'user@example.org',\n        userName: 'user',\n        password: 'Testtest.123',\n        firstName: 'Us',\n        lastName: 'Er',\n        isAdmin: false,\n        gender: 'other',\n        phone: '12123',\n        street: 'street',\n        zip: 'zip',\n        city: 'city',\n        country: 'country'\n    };\n    stub(userService, 'register').returns(Promise.resolve(stubUser));\n    const res = await request(app)\n      .post('/api/user/register')\n      .send(\n        stubUser\n      )\n      .set('Accept', 'application/json')\n      .expect(200);\n    console.log(res.body);\n    expect(res.body).to.exist;\n  });\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8fa85e3853c437bf1c036be763d293928d8d4fbf"}}